// This file configures how static assets are handled
import { copyFile, mkdir } from 'fs/promises';
import { resolve, dirname } from 'path';
import { fileURLToPath } from 'url';

const __dirname = dirname(fileURLToPath(import.meta.url));

// Function to copy all assets from _media to public
export async function copyMediaAssets() {
  try {
    // Create the public directory structure
    await mkdir(resolve(__dirname, '../.vitepress/dist/media'), { recursive: true });
    await mkdir(resolve(__dirname, '../.vitepress/dist/media/thumbnails'), { recursive: true });
    
    // Copy placeholder assets
    await copyFile(
      resolve(__dirname, '../_media/audio-placeholder.svg'),
      resolve(__dirname, '../.vitepress/dist/media/audio-placeholder.svg')
    );
    
    await copyFile(
      resolve(__dirname, '../_media/video-placeholder.svg'),
      resolve(__dirname, '../.vitepress/dist/media/video-placeholder.svg')
    );
    
    await copyFile(
      resolve(__dirname, '../_media/generic-placeholder.svg'),
      resolve(__dirname, '../.vitepress/dist/media/generic-placeholder.svg')
    );
    
    // In a real implementation, you would also copy all the files from
    // the thumbnails directory, but this depends on your build process
    
    console.log('Media assets copied successfully');
  } catch (error) {
    console.error('Error copying media assets:', error);
  }
}
